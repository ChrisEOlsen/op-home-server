version: v3

teleport:
  nodename: the_claaaaw # Replace with your machines name
  data_dir: /var/lib/teleport
  log:
    output: stderr
    severity: INFO
    format:
      output: text

auth_service:
  enabled: "yes"
  listen_addr: 0.0.0.0:3025
  cluster_name: teleport.my_server.com # Replace with the domain you want your Teleport dashboard to live

ssh_service:
  enabled: "yes"
  listen_addr: 0.0.0.0:3022

proxy_service:
  enabled: "yes"
  web_listen_addr: 0.0.0.0:443  # Listen on all interfaces
  public_addr: teleport.my_server.com:443 # Replace with the domain you want your Teleport dashboard to live add :443

  acme:
    enabled: "no"  # Disable ACME completely because this will only be running locally, and outside communication is running via cloudflare
# NOTE: This configuration assumes that the linux host is hiding behind CGNAT, and therefore cannot use ACME to resolve the domain name. 
# However, this is safe when your Cloudlfare tunnel points to https://localhost:443. All internal traffic is still encrypted via the proxy